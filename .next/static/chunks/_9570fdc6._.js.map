{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/george/Dropbox/machine_learning/margaret-flower-app-main/lib/supabaseClient.ts"],"sourcesContent":["// lib/supabaseClient.ts\n'use client';\nimport { createClient } from '@supabase/supabase-js';\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);"],"names":[],"mappings":"AAAA,wBAAwB;;;;AAKtB;AAHF;AADA;;AAGO,MAAM,WAAW,CAAA,GAAA,oQAAA,CAAA,eAAY,AAAD","debugId":null}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///Users/george/Dropbox/machine_learning/margaret-flower-app-main/components/admin/sign-in.tsx"],"sourcesContent":["// components/admin/sign-in.tsx\n'use client';\n\nimport { useState } from 'react';\nimport { supabase } from '@/lib/supabaseClient';\n\nexport default function SignIn({ initialEmail = '', initialTab = 'password' }: { initialEmail?: string; initialTab?: string }) {\n  const [email, setEmail] = useState(initialEmail);\n  const [password, setPassword] = useState('');\n  const [mode, setMode] = useState<'password' | 'magic' | 'reset'>((initialTab as 'password' | 'magic' | 'reset') || 'password');\n  const [sent, setSent] = useState(false);\n  const [err, setErr] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  const onPasswordSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErr(null);\n    setLoading(true);\n    \n    const { data, error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n    \n    if (error) {\n      setErr(error.message);\n    } else {\n      // Success! Wait a moment for session to be established, then redirect\n      console.log('üéâ Sign-in successful:', data.user?.email);\n      \n      // Verify session is established\n      const { data: sessionData } = await supabase.auth.getSession();\n      console.log('üìù Session after sign-in:', sessionData.session?.user?.email);\n      \n      // Store debug info in localStorage so we can see it even after redirect\n      localStorage.setItem('debug_signin', JSON.stringify({\n        signInUser: data.user?.email,\n        sessionUser: sessionData.session?.user?.email,\n        timestamp: new Date().toISOString()\n      }));\n      \n      // Show user feedback before redirect\n      setErr(`‚úÖ Successfully signed in as ${data.user?.email}. Redirecting to admin panel...`);\n      \n      // Wait longer for the session to be fully established\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      // Use a special parameter to indicate successful authentication\n      const authToken = btoa(data.user?.email + ':' + Date.now());\n      window.location.replace(`/admin?auth=${authToken}`);\n    }\n    setLoading(false);\n  };\n\n  const onMagicSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErr(null);\n    setLoading(true);\n    \n    const { error } = await supabase.auth.signInWithOtp({\n      email,\n      options: { emailRedirectTo: `${location.origin}/auth/callback` },\n    });\n    \n    if (error) {\n      setErr(error.message);\n    } else {\n      setSent(true);\n    }\n    setLoading(false);\n  };\n\n  const onResetSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErr(null);\n    setLoading(true);\n    \n    const { error } = await supabase.auth.resetPasswordForEmail(email, {\n      redirectTo: `${location.origin}/auth/reset-password`,\n    });\n    \n    if (error) {\n      setErr(error.message);\n    } else {\n      setSent(true);\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"max-w-md space-y-4\">\n      {/* Toggle between authentication methods */}\n      <div className=\"grid grid-cols-3 rounded-lg border p-1 bg-gray-50\">\n        <button\n          type=\"button\"\n          onClick={() => setMode('password')}\n          className={`py-2 px-2 text-xs font-medium rounded-md transition-colors ${\n            mode === 'password'\n              ? 'bg-white text-gray-900 shadow-sm'\n              : 'text-gray-500 hover:text-gray-700'\n          }`}\n        >\n          Sign In\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => setMode('reset')}\n          className={`py-2 px-2 text-xs font-medium rounded-md transition-colors ${\n            mode === 'reset'\n              ? 'bg-white text-gray-900 shadow-sm'\n              : 'text-gray-500 hover:text-gray-700'\n          }`}\n        >\n          Set Password\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => setMode('magic')}\n          className={`py-2 px-2 text-xs font-medium rounded-md transition-colors ${\n            mode === 'magic'\n              ? 'bg-white text-gray-900 shadow-sm'\n              : 'text-gray-500 hover:text-gray-700'\n          }`}\n        >\n          Magic Link\n        </button>\n      </div>\n\n      {mode === 'password' && (\n        <form onSubmit={onPasswordSubmit} className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-medium mb-1\">Email</label>\n            <input\n              className=\"w-full rounded-md border px-3 py-2\"\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium mb-1\">Password</label>\n            <input\n              className=\"w-full rounded-md border px-3 py-2\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n            />\n          </div>\n          <button \n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50\"\n          >\n            {loading ? 'Signing in...' : 'Sign In'}\n          </button>\n        </form>\n      )}\n\n      {mode === 'reset' && (\n        <form onSubmit={onResetSubmit} className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-medium mb-1\">Email</label>\n            <input\n              className=\"w-full rounded-md border px-3 py-2\"\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n            />\n          </div>\n          <button \n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full rounded-md bg-orange-600 px-3 py-2 text-sm font-medium text-white hover:bg-orange-700 disabled:opacity-50\"\n          >\n            {loading ? 'Sending...' : 'Send Password Reset'}\n          </button>\n          {sent && <p className=\"text-sm text-green-700\">Check your email for the password reset link.</p>}\n        </form>\n      )}\n\n      {mode === 'magic' && (\n        <form onSubmit={onMagicSubmit} className=\"space-y-3\">\n          <div>\n            <label className=\"block text-sm font-medium mb-1\">Email</label>\n            <input\n              className=\"w-full rounded-md border px-3 py-2\"\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n            />\n          </div>\n          <button \n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white hover:bg-green-700 disabled:opacity-50\"\n          >\n            {loading ? 'Sending...' : 'Send Magic Link'}\n          </button>\n          {sent && <p className=\"text-sm text-green-700\">Check your email for the sign-in link.</p>}\n        </form>\n      )}\n      \n      {err && <p className=\"text-sm text-red-600 bg-red-50 p-3 rounded-md\">{err}</p>}\n      \n      {mode === 'password' && (\n        <div className=\"text-xs text-gray-500 bg-gray-50 p-3 rounded-md\">\n          <p><strong>First time?</strong> Click &quot;Set Password&quot; to create your password.</p>\n          <p>Your admin account already exists - you just need to set a password.</p>\n        </div>\n      )}\n\n      {mode === 'reset' && (\n        <div className=\"text-xs text-gray-500 bg-gray-50 p-3 rounded-md\">\n          <p><strong>Password Reset:</strong> Enter your admin email address to receive a secure link.</p>\n          <p>You&apos;ll be able to set a new password that you can use for future logins.</p>\n          <p><strong>Note:</strong> Only authorized admin emails will receive reset links.</p>\n        </div>\n      )}\n\n      {mode === 'magic' && (\n        <div className=\"text-xs text-gray-500 bg-gray-50 p-3 rounded-md\">\n          <p><strong>Magic Link:</strong> Get a one-time login link sent to your email.</p>\n          <p><strong>‚ö†Ô∏è Warning:</strong> Magic links expire very quickly (within seconds).</p>\n          <p><strong>Tip:</strong> Use &quot;Set Password&quot; for a more reliable login method.</p>\n        </div>\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}